<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AusSuper International Shares (Live Scrape)</title>
<style>
  body { 
    font-family: Arial, sans-serif; 
    padding: 40px; 
    max-width: 600px; 
    margin: auto; 
    background: #f5f5f5; 
    text-align: center; 
  }
  #output { 
    font-size: 3.5em; 
    margin: 30px 0; 
    padding: 40px; 
    background: white; 
    border-radius: 20px; 
    box-shadow: 0 6px 30px rgba(0,0,0,0.15); 
    font-weight: bold;
  }
  button { 
    padding: 15px 35px; 
    font-size: 1.3em; 
    background: #0078d4; 
    color: white; 
    border: none; 
    border-radius: 10px; 
    cursor: pointer; 
    margin: 10px; 
  }
  button:hover { background: #106ebe; }
  .status { 
    font-size: 1.2em; 
    color: #666; 
    margin: 15px 0; 
  }
</style>
</head>
<body>

<h1>ü§ë AusSuper International Shares</h1>
<div class="status" id="status">Loading live data...</div>
<div id="output">‚è≥</div>
<button id="refreshBtn">üîÑ Refresh Live Data</button>

<script>
const TARGET_URL = 'https://www.australiansuper.com/why-choose-us/our-performance?superType=Super&display=table';

async function scrapeData() {
  const status = document.getElementById('status');
  const output = document.getElementById('output');
  
  status.textContent = '‚è≥ Fetching performance page...';
  output.textContent = '‚è≥';
  
  try {
    // Use CORS proxy to fetch the HTML page
    const proxyUrl = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(TARGET_URL);
    const response = await fetch(proxyUrl);
    const html = await response.text();
    
    // Parse HTML with DOMParser
    const parser = new DOMParser();
    const doc = parser.parseFromString(html, 'text/html');
    
    // Find International Shares row
    const intlRow = doc.querySelector('th a[href*="/investments/your-investment-options/diy-mixed-investment-choice"]')?.closest('tr');
    
    if (!intlRow) {
      throw new Error('International Shares row not found');
    }
    
    // Get all <td> cells (percentage values)
    const cells = Array.from(intlRow.querySelectorAll('td'));
    
    // Find LAST non-zero percentage (remove % and parse)
    let lastNonZero = null;
    for (let i = cells.length - 1; i >= 0; i--) {
      const cellText = cells[i].textContent.trim();
      const value = parseFloat(cellText.replace('%', ''));
      
      if (!isNaN(value) && Math.abs(value) > 0.0001) {
        lastNonZero = value;
        break;
      }
    }
    
    if (lastNonZero === null) {
      output.textContent = 'Currently no change.';
      output.style.color = '#666';
      status.textContent = '‚úÖ No recent movement';
    } else {
      const pct = lastNonZero.toFixed(4);
      output.textContent = `${pct}%`;
      output.style.color = lastNonZero >= 0 ? '#00aa44' : '#cc0000';
      status.textContent = `‚úÖ Latest: ${lastNonZero >= 0 ? '‚Üë' : '‚Üì'} ${Math.abs(lastNonZero).toFixed(4)}%`;
    }
    
  } catch (error) {
    status.textContent = `‚ùå Error: ${error.message}`;
    output.textContent = 'Failed';
    output.style.color = '#cc0000';
  }
}

// Auto-run on load
scrapeData();

// Refresh button
document.getElementById('refreshBtn').addEventListener('click', scrapeData);
</script>

</body>
</html>
